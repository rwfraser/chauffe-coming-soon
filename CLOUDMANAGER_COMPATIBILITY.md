# CloudManager.py Compatibility Documentation

## My Chauffe Web App v1.0.0 - CloudManager Requirements

This document specifies the CloudManager.py API requirements and compatibility for **My Chauffe Web Application v1.0.0**.

---

## üîÑ **Major Version Compatibility System**

**IMPORTANT:** Starting with v1.0.0, both applications follow a **major version compatibility model**:

- **Compatible Versions:** Applications with the same major version number are compatible
- **Breaking Changes:** Any breaking change in either application requires major version bump in BOTH
- **Current Compatibility:** My Chauffe v1.x.x ‚Üî CloudManager.py v1.x.x

### Version Matrix
| My Chauffe | CloudManager.py | Status |
|------------|-----------------|--------|
| v1.x.x     | v1.x.x         | ‚úÖ Compatible |
| v1.x.x     | v2.x.x         | ‚ùå Incompatible |
| v2.x.x     | v1.x.x         | ‚ùå Incompatible |
| v2.x.x     | v2.x.x         | ‚úÖ Compatible |

---

## üìã **Required CloudManager.py Version**

- **Major Version:** v1.x.x (any v1 release)
- **Minimum Version:** v1.0.0 or later
- **Recommended Version:** v1.3.0+
- **Last Tested With:** v1.3.0

---

## üîå **Required API Endpoints**

### 1. Health & System Information
```
GET /api/health
```
**Purpose:** Check CloudManager service status and availability
**Response Format:**
```json
{
    "success": true,
    "status": "healthy",
    "timestamp": "2025-01-15T10:00:00Z"
}
```

### 2. Version Information
```
GET /api/version
```
**Purpose:** Get CloudManager version for compatibility verification
**Response Format:**
```json
{
    "version": "1.3.0",
    "api_version": "1.0",
    "build": "abc123"
}
```

### 3. List All Blockchains
```
GET /api/blockchains
```
**Purpose:** Retrieve all managed blockchain instances
**Response Format:**
```json
{
    "success": true,
    "blockchains": {
        "blockchain_id_1": {
            "user_uuid": "user-uuid-here",
            "controller_name": "Controller Name",
            "controller_role": "manager",
            "name": "Blockchain Name",
            "created_at": "2025-01-15T10:00:00Z",
            "dloid_params": "0000000100011011001001",
            "genesis_dloid": "0x1a2b3c...",
            "dloid_info": {...}
        }
    }
}
```

### 4. Get Blockchain Details
```
GET /api/blockchains/{blockchain_id}
```
**Purpose:** Retrieve detailed information for specific blockchain
**Response Format:**
```json
{
    "success": true,
    "blockchain_id": "blockchain_id",
    "chain_info": {
        "length": 15,
        "pending_transactions": 3,
        "difficulty": 4
    },
    "metadata": {...}
}
```

### 5. Create New Blockchain
```
POST /api/blockchains
```
**Purpose:** Create new blockchain for user
**Required Payload:**
```json
{
    "user_uuid": "user-uuid-here",
    "first_name": "John",
    "last_name": "Doe",
    "existing_licenses": 0,
    "controller_role": "manager",
    "difficulty": 4,
    "name": "Optional Blockchain Name",
    "dloid_params": {
        "chauffe_quantity": 1000,
        "partnership": true,
        "collateralizable": false,
        // ... other DLOID parameters
    }
}
```

---

## üìä **Required Data Structures**

### User UUID Format
- **Type:** UUID v4 string
- **Example:** `"550e8400-e29b-41d4-a716-446655440000"`
- **Usage:** Primary identifier linking web app users to blockchain data

### DLOID Parameters Format
- **Length:** 25 characters
- **Structure:** 
  - Characters 0-9: CHAUFFEcoin quantity (zero-padded)
  - Character 10: Partnership flag (0/1)
  - Character 11: Collateralizable (0/1)
  - Character 12: Inheritance (0/1)
  - Character 13: Convertibility (0/1)
  - Characters 14-22: Rating (9-digit number)
  - Character 23: Share eligible (0/1)
  - Character 24: Redeemability (0/1)

### Controller Names
- **Format:** Free text string
- **Purpose:** Human-readable identifier for blockchain controllers
- **Generated by:** My Chauffe controller generator feature

---

## üöÄ **Performance Requirements**

### Response Times
- `/api/health`: < 1 second
- `/api/blockchains`: < 5 seconds
- `/api/blockchains/{id}`: < 2 seconds
- `POST /api/blockchains`: < 10 seconds

### Concurrent Requests
- Minimum support for 10 concurrent API requests
- Graceful degradation under load

### Error Handling
- Proper HTTP status codes (200, 400, 404, 500)
- JSON error responses with descriptive messages
- Connection timeout handling (10-second default)

---

## üîß **Configuration Requirements**

### Network Settings
- **Default Port:** 5000
- **Protocol:** HTTP (HTTPS in production)
- **CORS:** Allow requests from My Chauffe web app domains

### Environment Variables
CloudManager.py should support:
- `PORT`: API server port (default: 5000)
- `LOG_LEVEL`: Logging verbosity
- `DATA_DIRECTORY`: Blockchain data storage location

---

## üß™ **Testing & Validation**

### Integration Test Script
My Chauffe includes a test script to validate CloudManager compatibility:
```bash
python test_cloudmanager_integration.py
```

### Health Check Validation
The web app continuously monitors CloudManager health via:
1. Periodic health endpoint calls
2. Connection timeout detection  
3. Error response handling
4. Graceful fallback to local data when CloudManager is unavailable

---

## üìù **Version History & Changes**

### My Chauffe v1.0.0 (Major Release)
- **BREAKING:** Established major version compatibility system with CloudManager.py
- **Added:** Asynchronous profile loading to prevent CloudManager delays
- **Added:** Purchase success page with controller generation links  
- **Enhanced:** Error handling for CloudManager connectivity issues
- **Improved:** User experience with loading states and progressive updates
- **Formalized:** API compatibility requirements and versioning strategy

### CloudManager.py v1.x.x Requirements
- Support for user UUID-based blockchain filtering
- Consistent DLOID parameter format (25-character string)
- Reliable health check endpoint with version information
- Controller name and role metadata storage
- **MUST:** Report major version v1.x.x in `/api/version` endpoint

---

## üö® **Known Issues & Limitations**

### Current Limitations
1. **Single CloudManager Instance:** Web app expects one CloudManager.py instance
2. **HTTP Only:** No HTTPS support in current implementation
3. **No Authentication:** API calls are unauthenticated

### Future Enhancements
- Multi-instance CloudManager support
- HTTPS/TLS encryption
- API key authentication
- Real-time WebSocket updates

---

## üîç **Troubleshooting**

### Common Issues

1. **Connection Refused**
   - Ensure CloudManager.py is running on configured port
   - Check firewall settings
   - Verify CORS configuration

2. **Timeout Errors**
   - CloudManager may be overloaded
   - Check CloudManager.py logs
   - Consider increasing timeout settings

3. **Invalid Response Format**
   - Verify CloudManager.py version compatibility
   - Check API endpoint implementations
   - Review CloudManager.py logs for errors

### Debugging Tools
- My Chauffe API Test page: `/api-test/`
- Integration test script: `test_cloudmanager_integration.py`
- Django logs with CloudManager client debugging

---

## üìû **Support & Contact**

For CloudManager.py compatibility issues:
1. Check this documentation for requirements
2. Run integration tests to identify specific issues
3. Review CloudManager.py logs for error details
4. Test individual API endpoints using the web app's API test page

**Last Updated:** October 15, 2025  
**Documentation Version:** 2.0  
**Compatible with:** My Chauffe Web App v1.0.0  
**Requires:** CloudManager.py v1.x.x
